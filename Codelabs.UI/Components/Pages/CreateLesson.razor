@page "/create-lesson"
@rendermode InteractiveServer

<PageTitle>Создание урока</PageTitle>

<head>
    <link rel="stylesheet" href="css/buttons.css" />
    <link rel="stylesheet" href="css/items.css" />
</head>

<div class="create-lesson-box">
    <EditForm style="width: 100%;" Model="lessonModel" OnValidSubmit="GoNextStep" FormName="createLessonForm">
        <div class="step-box">
            @switch (_step)
            {
                case 1:
                    <CreateLessonStep1 lessonModel="lessonModel" />
                    break;
                case 2:
                    <CreateLessonStep2 lessonModel="lessonModel" />
                    break;
                case 3:
                    <CreateLessonStep3 />
                    break;
            }
        </div>
        <div class="pagination-box">
            <button class="pagination-button" style="width: 50px;background-color: @GetColor(1);" @onclick="() => {ChangeStep(1);}">1</button>
            <button class="pagination-button" style="width: 50px;background-color: @GetColor(2);" @onclick="() => {ChangeStep(2);}">2</button>
            <button class="pagination-button" style="width: 50px;background-color: @GetColor(3);" @onclick="() => {ChangeStep(3);}">3</button>
            @if (_step != 3)
            {
                <button type="submit" class="pagination-button" style="width: 120px;background-color: #01ff66;" @onclick="NextStep">Далее</button>
            }
            @if (_step == 3)
            {
                <button type="submit" class="pagination-button" style="width: 180px;background-color: #01ff66;" @onclick="FinishCreate">Завершить</button>
            }
        </div>
    </EditForm>
</div>

@code {
    [SupplyParameterFromQuery]
    public int? user_id { get; set; }

    [SupplyParameterFromForm]
    public LessonInputModel lessonModel { get; set; } = new();

    private int _step = 1;

    private List<LessonInputModel> _models = new();

    public void GoNextStep()
    {
        Console.WriteLine(lessonModel.Name);
    }

    private void ChangeStep(int nextStep)
    {
        _step = nextStep;
    }

    private void NextStep()
    {
        if (_step == 3)
        {
            _step = 1;
        }
        else
        {
            _step++;
        }
    }

    private void FinishCreate()
    {

    }

    private string GetColor(int number)
    {
        if (number != _step)
        {
            return "#01ff66";
        }
        else
        {
            return "#fff701";
        }
    }
}